import time
import traceback
from datetime import date, datetime
from os import name

import requests
from pywebio.input import *
from pywebio.output import *
from pywebio.pin import *
from pywebio.session import *
from requests.adapters import HTTPAdapter

'''
è¿™é‡Œçš„ä»£ç æ˜¯ç”¨æ¥çˆ¬å–æ•°æ®å¹¶æå–å‡ºæ‰€éœ€è¦çš„å­—æ®µæ•°æ®ï¼Œå› éšç§åŸå› ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ã€‚è¿™ä¸ªæ¨¡å—æ˜¯è¢«mainå¼•ç”¨çš„å“Ÿï¼
'''

# ç™»å½•çŠ¶æ€
def æ£€æŸ¥ç™»å½•çŠ¶æ€(name):
    url = 'http://api.smart-insight-service.com:40423/case_data_batch?a=paginate&query=&page_count=6&_=1638612090870'
    headers = {
        'Accept':
        'application/json, text/javascript, */*; q=0.01',
        'Accept-Encoding':
        'gzip, deflate',
        'Accept-Language':
        'zh-CN,zh;q=0.9',
        'Authorization':
        '',
        'Connection':
        'keep-alive',
        'Host':
        'api.smart-insight-service.com:40423',
        'Origin':
        'http://saas.smart-insight-service.com:40423',
        'Referer':
        'http://saas.smart-insight-service.com:40423/case/case_search/detail.html',
        'User-Agent':
        'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'
    }

    while True:
        try:
            with open('è´¦å·ä¿¡æ¯.txt', encoding='utf-8') as f:
                au = f.readline()
                di = eval(au)
                # print(au)
        except:
            di = {}
            au = input('æ— æ­¤è´¦å·ï¼Œæ­£åœ¨æ³¨å†Œï¼Œè¯·æŒ‰F12ï¼Œæ‰¾åˆ°èº«ä»½è¯†åˆ«ä¿¡æ¯å¤åˆ¶è¿‡æ¥', type=TEXT, placeholder='è¿™ä¸ªèº«ä»½è¯†åˆ«ä¿¡æ¯æœ‰ç‚¹å¤æ‚', help_text='ä¸æ‡‚çš„é—®ç®¡ç†å‘˜å“¦', required=True)
            di[name] = au
            di = str(di)
            with open('è´¦å·ä¿¡æ¯.txt', 'w', encoding='utf-8') as f:
                f.write(di)

        headers['Authorization'] = di.get(name)

        try:
            req = requests.get(url=url, headers=headers)
            r = req.json()
            # put_text('æ­£åœ¨æ£€æŸ¥ç™»å½•çŠ¶æ€.....')
            è¿”å›çŠ¶æ€ = r.get('msg')
            put_text(è¿”å›çŠ¶æ€)
        except:
            put_text('è·å–å¤±è´¥,è¯·æ£€æŸ¥ç½‘å€æˆ–ç½‘ç»œ!')

        if è¿”å›çŠ¶æ€ == 'è¯·æ±‚æˆåŠŸ':
            break
        else:
            au = input('æ— æ­¤è´¦å·æˆ–è´¦å·ç™»å½•çŠ¶æ€å·²å¤±æ•ˆï¼Œè¯·é€‰æ‹©æ‰€å±å›¢é˜Ÿï¼ŒæŒ‰F12æ‰¾åˆ°èº«ä»½è¯†åˆ«ä¿¡æ¯å¹¶å¤åˆ¶è¿‡æ¥', type=TEXT, placeholder='æ¯æ¬¡é€€å‡ºç™»å½•æˆ–è€…å…³é—­æµè§ˆå™¨éƒ½éœ€è¦é‡æ–°æ·»åŠ çš„', help_text='ä¸æ‡‚çš„é—®ç®¡ç†å‘˜å“¦', required=True)
            di[name] = au
            di = str(di)
            with open('è´¦å·ä¿¡æ¯.txt', 'w', encoding='utf-8') as f:
                f.write(di)
    return headers

def æ›´æ”¹ç™»å½•å›¢é˜Ÿ():
    è´¦å· = input('è¯·é‡æ–°è¾“å…¥ä½ çš„ç³»ç»Ÿå¸å·ç™»å½•ğŸ˜Š', type=TEXT, placeholder='æ˜¯ç³»ç»Ÿçš„è´¦å·å“ŸğŸ˜€', help_text='åˆ‡æ¢åˆ°æ‰€éœ€è¦çš„å›¢é˜Ÿ', required=True)
    
    with open('è´¦å·ä¿¡æ¯.txt', encoding='utf-8') as f:
        au = f.readline()
        di = eval(au)

    au = input('è¯·é€‰æ‹©æ‰€å±å›¢é˜Ÿï¼ŒæŒ‰F12æ‰¾åˆ°èº«ä»½è¯†åˆ«ä¿¡æ¯å¹¶å¤åˆ¶è¿‡æ¥', type=TEXT, placeholder='é‡æ–°è¾“å…¥æ‰€å±å›¢é˜Ÿçš„èº«ä»½æ ‡è¯†', help_text='', required=True)
    di[è´¦å·] = au
    di = str(di)
    with open('è´¦å·ä¿¡æ¯.txt', 'w', encoding='utf-8') as f:
        f.write(di)

    æ£€æŸ¥ç™»å½•çŠ¶æ€(è´¦å·)

# è·å–ç½‘å€
def èº«ä»½è¯å·æŸ¥è¯¢ç½‘å€(èº«ä»½è¯å·, æ¡ˆä»¶æ•°=10, é¡µæ•°=1):
    url = f'http://api.smart-insight-service.com:40423/case_medical?a=paginate&cur_page={é¡µæ•°}&page_count={æ¡ˆä»¶æ•°}&id_no={èº«ä»½è¯å·}&_=1632296854055'
    return url

def æ¡ˆä»¶å·æŸ¥è¯¢ç½‘å€(æ¡ˆä»¶å·):
    url = f'http://api.smart-insight-service.com:40423/case_medical?a=paginate&no={æ¡ˆä»¶å·}&_=1635560354271'
    return url

def æ‰¹æ¬¡å·æŸ¥è¯¢ç½‘å€(æ‰¹æ¬¡å·, æ¡ˆä»¶æ•°=10, é¡µæ•°=1):
    url = f'http://api.smart-insight-service.com:40423/case_medical?a=paginate&cur_page={é¡µæ•°}&page_count={æ¡ˆä»¶æ•°}&batch_no={æ‰¹æ¬¡å·}&_=1637329954374'
    return url

def æ‰¹æ¬¡å·å›ä¼ æŸ¥è¯¢ç½‘å€(æ‰¹æ¬¡å·, å›ä¼ çŠ¶æ€, æ¡ˆä»¶æ•°=10, é¡µæ•°=1):
    url = f'http://api.smart-insight-service.com:40423/case_medical?a=paginate&cur_page={é¡µæ•°}&page_count={æ¡ˆä»¶æ•°}&batch_no={æ‰¹æ¬¡å·}&send_status={å›ä¼ çŠ¶æ€}&_=1635821545417'
    return url

def åˆ—è¡¨é¡µç†ç®—ç»“æœæŸ¥è¯¢ç½‘å€(æ¡ˆä»¶å·):
    url = f'http://api.smart-insight-service.com:40423/case_adjuster_result?a=duty_result_detail&case_no={æ¡ˆä»¶å·}&_=1632296854056'
    return url

def åˆ—è¡¨é¡µç†ç®—ç»“æœè¯¦æƒ…é¡µé¢æŸ¥è¯¢ç½‘å€(æ¡ˆä»¶id):
    url = f'http://api.smart-insight-service.com:40423/case_adjuster_result?a=detail&result_id=0&case_id={æ¡ˆä»¶id}&_=1641733395628'
    return url

def æ¡ˆä»¶è¯¦æƒ…æŸ¥è¯¢ç½‘å€(æ¡ˆä»¶id):
    url = f'http://api.smart-insight-service.com:40423/case_medical?a=detail&medical_id=0&case_id={æ¡ˆä»¶id}&_=1638670784300'
    return url

def æ¡ˆä»¶è¯¦æƒ…é¡µé¢†æ¬¾äººä¸å—ç›Šäººç½‘å€(æ¡ˆä»¶id):
    url = f'http://api.smart-insight-service.com:40423/case_beneficiary_payee?a=detail&medical_id={æ¡ˆä»¶id}'
    return url

def æ¡ˆä»¶è¯¦æƒ…é¡µç”³è¯·äººç½‘å€(æ¡ˆä»¶id):
    url = f'http://api.smart-insight-service.com:40423/case_beneficiary_payee?a=detail_applicant&medical_id={æ¡ˆä»¶id}'
    return url

def æ¡ˆä»¶è¯¦æƒ…é€€å•æŸ¥è¯¢ç½‘å€(ç¥¨æ®ç±»å‹, æ¡ˆä»¶id, ç¥¨æ®id):
    # type=1æ˜¯åŸé•‡å±…æ°‘é—¨è¯Šï¼Œ2æ˜¯åŸé•‡èŒå·¥é—¨è¯Šï¼Œ=3æ˜¯ä½é™¢ï¼Œ=5æ˜¯é—¨ç‰¹ï¼›stub_idå¯¹åº”ç½‘å€iteam_id
    url = f'http://api.smart-insight-service.com:40423/case_medical?a=get_drug_fee_note&type={ç¥¨æ®ç±»å‹}&case_id={æ¡ˆä»¶id}&iteam_id={ç¥¨æ®id}&_=1638276609808'
    return url

def æ¡ˆä»¶è¯¦æƒ…ä¿æœŸæŸ¥è¯¢ç½‘å€(ä¿æœŸæŸ¥è¯¢å·, ä¿å•å·):
    # æ¡ˆä»¶è¯¦æƒ…é¡µè·å–ä¿¡æ¯å†…å®¹
    url = f'http://api.smart-insight-service.com:40423/case_medical?a=detail_duty&assurer_id={ä¿æœŸæŸ¥è¯¢å·}&insurance_no={ä¿å•å·}'
    return url

# æå–å†…å®¹
def æå–æ¡ˆä»¶åˆ—è¡¨æ•°é‡(x):
    if x:
        å½“å‰é¡µæ•° = x.get('cur_page')
        æ¡ˆä»¶æ•°é‡ = x.get('count')
        å½“å‰é¡µæœ€å¤§æ˜¾ç¤ºé¡µæ•° = x.get('end_page')
        æ€»é¡µæ•° = x.get('pages')

        data = {'å½“å‰é¡µæ•°': å½“å‰é¡µæ•°, 'æ¡ˆä»¶æ•°é‡': æ¡ˆä»¶æ•°é‡, 'å½“å‰é¡µæœ€å¤§æ˜¾ç¤ºé¡µæ•°': å½“å‰é¡µæœ€å¤§æ˜¾ç¤ºé¡µæ•°, 'æ€»é¡µæ•°': æ€»é¡µæ•°}
    else:
        data = {}
        put_text('æ²¡æœ‰åˆ—è¡¨æ•°é‡ä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶åˆ—è¡¨ä¸ªæ¡ˆè¯¦æƒ…(x):
    if x:
        å§“å = x.get('name')
        æ‰¹æ¬¡å· = x.get('batch_no')
        æ¡ˆä»¶å· = x.get('no')
        èº«ä»½è¯å· = x.get('id_no')
        ä¸Šä¼ æ—¶é—´ = x.get('case_data').get('upload_time')
        å›ä¼ æ—¶é—´ = x.get('case_data').get('send_time')
        æ¡ˆä»¶çŠ¶æ€ = x.get('case_status')    # æ¡ˆä»¶çš„å„ç§çŠ¶æ€,å¯æ£€æŸ¥æ ¸æŸ¥çŠ¶æ€
        æ¡ˆä»¶id = x.get('case_id')
        å®¡æ ¸å‘˜ = x.get('user').get('nickname')
        ç†ç®—çŠ¶æ€ = x.get('adjuster_name')
        ç†ç®—æ ‡è¯† = x.get('adjuster_status')
        èº«ä»½è¯å· = x.get('id_no')
        æ ¸æŸ¥çŠ¶æ€ = x.get('check_name')  # å’Œæ ¸æŸ¥æ ¡éªŒæ˜¯ä¸€ä¸ª
        æ ¸æŸ¥æ ¡éªŒ = x.get('is_check')

        data = {
            'å§“å': å§“å,
            'æ‰¹æ¬¡å·': æ‰¹æ¬¡å·,
            'æ¡ˆä»¶å·': æ¡ˆä»¶å·,
            'èº«ä»½è¯å·': èº«ä»½è¯å·,
            'ä¸Šä¼ æ—¶é—´': ä¸Šä¼ æ—¶é—´,
            'å›ä¼ æ—¶é—´': å›ä¼ æ—¶é—´,
            'æ¡ˆä»¶çŠ¶æ€': æ¡ˆä»¶çŠ¶æ€,
            'æ¡ˆä»¶id': æ¡ˆä»¶id,
            'å®¡æ ¸å‘˜': å®¡æ ¸å‘˜,
            'æ ¸æŸ¥çŠ¶æ€': æ ¸æŸ¥çŠ¶æ€,
            'ç†ç®—çŠ¶æ€': ç†ç®—çŠ¶æ€,
            'ç†ç®—æ ‡è¯†': ç†ç®—æ ‡è¯†,
            'èº«ä»½è¯å·': èº«ä»½è¯å·,
            'æ ¸æŸ¥æ ¡éªŒ': æ ¸æŸ¥æ ¡éªŒ
        }
    else:
        data = {}
        print('æ²¡æœ‰æ¡ˆä»¶åˆ—è¡¨ä¿¡æ¯')
    return data

def æå–åˆ—æ¡ˆä»¶è¡¨é¡µç†ç®—ç»“æœ(x):
    äººå¯¿ç»™ä»˜è´£ä»»ç¼–ç  = {
        'é—¨è¯Š': ['1081103301', '1121101402', '1121103402'],
        'ä½é™¢': ['1121101403', '1121101405', '1121103403', '1121101404', '1081102301'],
        'é—¨ç‰¹': ['1121101407']
        }
        
    if x:
        ä½é™¢æ ‡è¯† = 0
        é—¨è¯Šæ ‡è¯† = 0
        é—¨ç‰¹æ ‡è¯† = 0
        
        é—¨è¯Šä¸ªäººèµ”æ¡ˆå· = ''
        é—¨è¯Šä¿å•å· = ''
        é—¨è¯Šäº‹ä»¶å· = ''
        é—¨è¯Šç”³è¯·é‡‘é¢ = 0
        é—¨è¯Šå›ä¼ é‡‘é¢ = 0
        é—¨è¯Šè´£ä»»ç¼–ç  = ''
        é—¨è¯Šç»™ä»˜è´£ä»»ç¼–ç  = ''
        ä½é™¢ä¸ªäººèµ”æ¡ˆå· = ''
        ä½é™¢ä¿å•å· = ''
        ä½é™¢äº‹ä»¶å· = ''
        ä½é™¢ç”³è¯·é‡‘é¢ = 0
        ä½é™¢å›ä¼ é‡‘é¢ = 0
        ä½é™¢è´£ä»»ç¼–ç  = ''
        ä½é™¢ç»™ä»˜è´£ä»»ç¼–ç  = ''
        é—¨ç‰¹ä¸ªäººèµ”æ¡ˆå· = ''
        é—¨ç‰¹ä¿å•å· = ''
        é—¨ç‰¹äº‹ä»¶å· = ''
        é—¨ç‰¹ç”³è¯·é‡‘é¢ = 0
        é—¨ç‰¹å›ä¼ é‡‘é¢ = 0
        é—¨ç‰¹è´£ä»»ç¼–ç  = ''
        é—¨ç‰¹ç»™ä»˜è´£ä»»ç¼–ç  = ''
        ç”³è¯·æ€»é¢ = ''
        å›ä¼ æ€»é¢ = ''

        for i in x:
            for j in äººå¯¿ç»™ä»˜è´£ä»»ç¼–ç :
                if i.get('pay_duty_code') in äººå¯¿ç»™ä»˜è´£ä»»ç¼–ç [j]:

                    if 'é—¨è¯Š' == j:
                        if é—¨è¯Šæ ‡è¯† == 0:
                            é—¨è¯Šä¸ªäººèµ”æ¡ˆå· = i.get('event_no')
                            é—¨è¯Šä¿å•å· = i.get('insurance_no')
                            é—¨è¯Šäº‹ä»¶å· = i.get('compensation_no')
                            é—¨è¯Šç”³è¯·é‡‘é¢ = float(i.get('bill_money', 0))
                            é—¨è¯Šå›ä¼ é‡‘é¢ = float(i.get('insurance_pay', 0))
                            é—¨è¯Šè´£ä»»ç¼–ç  = i.get('duty_code')
                            é—¨è¯Šç»™ä»˜è´£ä»»ç¼–ç  = i.get('pay_duty_code')
                            é—¨è¯Šæ ‡è¯† = 1
                        else:
                            é—¨è¯Šç”³è¯·é‡‘é¢ += float(i.get('bill_money', 0))
                            é—¨è¯Šå›ä¼ é‡‘é¢ += float(i.get('insurance_pay', 0))
                            
                    elif 'ä½é™¢' == j:
                        if ä½é™¢æ ‡è¯† == 0:
                            ä½é™¢ä¸ªäººèµ”æ¡ˆå· = i.get('event_no')
                            ä½é™¢ä¿å•å· = i.get('insurance_no')
                            ä½é™¢äº‹ä»¶å· = i.get('compensation_no')
                            ä½é™¢ç”³è¯·é‡‘é¢ = float(i.get('bill_money', 0))
                            ä½é™¢å›ä¼ é‡‘é¢ = float(i.get('insurance_pay', 0))
                            ä½é™¢è´£ä»»ç¼–ç  = i.get('duty_code')
                            ä½é™¢ç»™ä»˜è´£ä»»ç¼–ç  = i.get('pay_duty_code')
                            ä½é™¢æ ‡è¯† = 1
                        else:
                            ä½é™¢ç”³è¯·é‡‘é¢ += float(i.get('bill_money', 0))
                            ä½é™¢å›ä¼ é‡‘é¢ += float(i.get('insurance_pay', 0))

                    elif 'é—¨ç‰¹' == j:
                        if é—¨ç‰¹æ ‡è¯† == 0:
                            é—¨ç‰¹ä¸ªäººèµ”æ¡ˆå· = i.get('event_no')
                            é—¨ç‰¹ä¿å•å· = i.get('insurance_no')
                            é—¨ç‰¹äº‹ä»¶å· = i.get('compensation_no')
                            é—¨ç‰¹ç”³è¯·é‡‘é¢ = float(i.get('bill_money', 0))
                            é—¨ç‰¹å›ä¼ é‡‘é¢ = float(i.get('insurance_pay', 0))
                            é—¨ç‰¹è´£ä»»ç¼–ç  = i.get('duty_code')
                            é—¨ç‰¹ç»™ä»˜è´£ä»»ç¼–ç  = i.get('pay_duty_code')
                            é—¨ç‰¹æ ‡è¯† = 1
                        else:
                            é—¨ç‰¹ç”³è¯·é‡‘é¢ += float(i.get('bill_money', 0))
                            é—¨ç‰¹å›ä¼ é‡‘é¢ += float(i.get('insurance_pay', 0))
                            

        ä½é™¢ç”³è¯·æ€»é¢ = round((ä½é™¢ç”³è¯·é‡‘é¢+é—¨ç‰¹ç”³è¯·é‡‘é¢), 2)
        ä½é™¢å›ä¼ æ€»é¢ = round((ä½é™¢å›ä¼ é‡‘é¢+é—¨ç‰¹å›ä¼ é‡‘é¢), 2)

        ç”³è¯·æ€»é¢ = round((é—¨è¯Šç”³è¯·é‡‘é¢+ä½é™¢ç”³è¯·æ€»é¢), 2)
        å›ä¼ æ€»é¢ = round((é—¨è¯Šå›ä¼ é‡‘é¢+ä½é™¢å›ä¼ æ€»é¢), 2)

        date = {
            'é—¨è¯Šä¸ªäººèµ”æ¡ˆå·': é—¨è¯Šä¸ªäººèµ”æ¡ˆå·,
            'é—¨è¯Šä¿å•å·': é—¨è¯Šä¿å•å·,
            'é—¨è¯Šäº‹ä»¶å·': é—¨è¯Šäº‹ä»¶å·,
            'é—¨è¯Šç”³è¯·é‡‘é¢': é—¨è¯Šç”³è¯·é‡‘é¢,
            'é—¨è¯Šå›ä¼ é‡‘é¢': é—¨è¯Šå›ä¼ é‡‘é¢,
            'é—¨è¯Šè´£ä»»ç¼–ç ': é—¨è¯Šè´£ä»»ç¼–ç ,
            'é—¨è¯Šç»™ä»˜è´£ä»»ç¼–ç ': é—¨è¯Šç»™ä»˜è´£ä»»ç¼–ç ,
            'ä½é™¢ä¸ªäººèµ”æ¡ˆå·': ä½é™¢ä¸ªäººèµ”æ¡ˆå·,
            'ä½é™¢ä¿å•å·': ä½é™¢ä¿å•å·,
            'ä½é™¢äº‹ä»¶å·': ä½é™¢äº‹ä»¶å·,
            'ä½é™¢ç”³è¯·é‡‘é¢': ä½é™¢ç”³è¯·é‡‘é¢,
            'ä½é™¢å›ä¼ é‡‘é¢': ä½é™¢å›ä¼ é‡‘é¢,
            'ä½é™¢è´£ä»»ç¼–ç ': ä½é™¢è´£ä»»ç¼–ç ,
            'ä½é™¢ç»™ä»˜è´£ä»»ç¼–ç ': ä½é™¢ç»™ä»˜è´£ä»»ç¼–ç ,
            'é—¨ç‰¹ä¸ªäººèµ”æ¡ˆå·': é—¨ç‰¹ä¸ªäººèµ”æ¡ˆå·,
            'é—¨ç‰¹ä¿å•å·': é—¨ç‰¹ä¿å•å·,
            'é—¨ç‰¹äº‹ä»¶å·': é—¨ç‰¹äº‹ä»¶å·,
            'é—¨ç‰¹ç”³è¯·é‡‘é¢': é—¨ç‰¹ç”³è¯·é‡‘é¢,
            'é—¨ç‰¹å›ä¼ é‡‘é¢': é—¨ç‰¹å›ä¼ é‡‘é¢,
            'é—¨ç‰¹è´£ä»»ç¼–ç ': é—¨ç‰¹è´£ä»»ç¼–ç ,
            'é—¨ç‰¹ç»™ä»˜è´£ä»»ç¼–ç ': é—¨ç‰¹ç»™ä»˜è´£ä»»ç¼–ç ,
            'ä½é™¢ç”³è¯·æ€»é¢': ä½é™¢ç”³è¯·æ€»é¢,
            'ä½é™¢å›ä¼ æ€»é¢': ä½é™¢å›ä¼ æ€»é¢,
            'ç”³è¯·æ€»é¢': ç”³è¯·æ€»é¢,
            'å›ä¼ æ€»é¢': å›ä¼ æ€»é¢
        }

    else:
        date = {}
        print('æ²¡æœ‰ç†ç®—ä¿¡æ¯')

    return date

def æå–æ¡ˆä»¶è¯¦æƒ…åŸºç¡€ä¿¡æ¯(x):
    if x:
        å§“å = x.get('name')
        è¯ä»¶ç±»å‹ = x.get('id_type_name')
        èº«ä»½è¯å· = x.get('id_no')
        æ€§åˆ« = x.get('gender_name')
        è”ç³»ç”µè¯ = x.get('phone')
        èŒä¸š = x.get('career').get('text')
        ç¤¾ä¿å· = x.get('ssn')
        é“¶è¡Œå = x.get('bank')
        é“¶è¡Œå¸å· = x.get('bank_no')
        ä¿å•é“¶è¡Œå = x.get('assurer_bank')
        ä¿å•é“¶è¡Œè´¦å· = x.get('assurer_bank_no')
        ä¿å•æ•° = x.get('insurance_list')
        ä¿å•å· = x.get('insurance_no')
        ä¿æœŸæŸ¥è¯¢å· = x.get('assurer_id')
        ä¿å•æ–¹æ¡ˆ = x.get('solution')
        ç”Ÿæ•ˆæ—¶é—´ = x.get('effect_time')
        ç‰¹æ®Šäººå‘˜æ ‡è¯† = x.get('special_personnel')
        åŒ»ä¿ç±»å‹ = x.get('type_name')
        é—®é¢˜ä»¶ = x.get('error_flag_name')
        é—®é¢˜ä»¶ç®€è¿° = x.get('error_remark')
        æ‰¹æ¬¡å· = x.get('batch_no')
        æ¡ˆä»¶å· = x.get('no')
        ç”³è¯·é‡‘é¢ = float(x.get('apply', 0))
        å¤‡æ³¨ = x.get('remark')
        if x.get('assurer'):
            æŠ•ä¿å•ä½ = x.get('assurer').get('company').get('name')
            å‡ºç”Ÿæ—¥æœŸ = x.get('assurer').get('birth_time')
            å¹´é¾„ = 2021 - int(èº«ä»½è¯å·[6:10]) + 1
            å›½ç± = x.get('assurer').get('country')
        else:
            æŠ•ä¿å•ä½ = 'æ— '
            å‡ºç”Ÿæ—¥æœŸ = 'æ— '
            å¹´é¾„ = 'æ— '
            å›½ç± = 'æ— '

        data = {
            'å§“å': å§“å,
            'è¯ä»¶ç±»å‹': è¯ä»¶ç±»å‹,
            'èº«ä»½è¯å·': èº«ä»½è¯å·,
            'æ€§åˆ«': æ€§åˆ«,
            'è”ç³»ç”µè¯': è”ç³»ç”µè¯,
            'èŒä¸š': èŒä¸š,
            'ç¤¾ä¿å·': ç¤¾ä¿å·,
            'é“¶è¡Œå': é“¶è¡Œå,
            'é“¶è¡Œå¸å·': é“¶è¡Œå¸å·,
            'ä¿å•é“¶è¡Œå': ä¿å•é“¶è¡Œå,
            'ä¿å•é“¶è¡Œè´¦å·': ä¿å•é“¶è¡Œè´¦å·,
            'ä¿å•æ•°': ä¿å•æ•°,
            'ä¿å•å·': ä¿å•å·,
            'ä¿æœŸæŸ¥è¯¢å·': ä¿æœŸæŸ¥è¯¢å·,
            'ä¿å•æ–¹æ¡ˆ': ä¿å•æ–¹æ¡ˆ,
            'ç”Ÿæ•ˆæ—¶é—´': ç”Ÿæ•ˆæ—¶é—´,
            'ç‰¹æ®Šäººå‘˜æ ‡è¯†': ç‰¹æ®Šäººå‘˜æ ‡è¯†,
            'åŒ»ä¿ç±»å‹': åŒ»ä¿ç±»å‹,
            'é—®é¢˜ä»¶': é—®é¢˜ä»¶,
            'é—®é¢˜ä»¶ç®€è¿°': é—®é¢˜ä»¶ç®€è¿°,
            'æ‰¹æ¬¡å·': æ‰¹æ¬¡å·,
            'æ¡ˆä»¶å·': æ¡ˆä»¶å·,
            'ç”³è¯·é‡‘é¢': ç”³è¯·é‡‘é¢,
            'å¤‡æ³¨': å¤‡æ³¨,
            'æŠ•ä¿å•ä½': æŠ•ä¿å•ä½,
            'å‡ºç”Ÿæ—¥æœŸ': å‡ºç”Ÿæ—¥æœŸ,
            'å¹´é¾„': å¹´é¾„,
            'å›½ç±': å›½ç±
        }

    else:
        data = {}
        print('æ²¡æœ‰åŸºç¡€ä¿¡æ¯')
    return data

def æå–ä¿æœŸä¿¡æ¯(x):
    # ä»¥åˆ—è¡¨å½¢å¼[{}]ä¼ å…¥å‚æ•°ï¼Œç­›é‡ä¹‹åå†ä»¥å­—å…¸å½¢å¼è¿”å›
    if x:
        # dicç”¨æ¥ç­›é‡ä¿å•æ–¹æ¡ˆ
        datas = {}
        for i in x:
            æ–¹æ¡ˆåç§° = i.get('sol_name')
            è´£ä»»åç§° = i.get('duty_name')
            è´£ä»»å§‹æœŸ = time.strftime("%Y-%m-%d", time.localtime(i.get('duty_begin_time')))
            è´£ä»»æ­¢æœŸ = time.strftime("%Y-%m-%d", time.localtime(i.get('duty_end_time')))
            ç»™ä»˜è´£ä»»åç§° = i.get('pay_duty_name')
            ç»™ä»˜è´£ä»»å§‹æœŸ = time.strftime("%Y-%m-%d", time.localtime(i.get('pay_duty_begin_time')))
            ç»™ä»˜è´£ä»»æ­¢æœŸ = time.strftime("%Y-%m-%d", time.localtime(i.get('pay_duty_end_time')))

            datas[æ–¹æ¡ˆåç§°] = {
                'è´£ä»»åç§°': è´£ä»»åç§°,
                'è´£ä»»å§‹æœŸ': è´£ä»»å§‹æœŸ,
                'è´£ä»»æ­¢æœŸ': è´£ä»»æ­¢æœŸ,
                'ç»™ä»˜è´£ä»»åç§°': ç»™ä»˜è´£ä»»åç§°,
                'ç»™ä»˜è´£ä»»å§‹æœŸ': ç»™ä»˜è´£ä»»å§‹æœŸ,
                'ç»™ä»˜è´£ä»»æ­¢æœŸ': ç»™ä»˜è´£ä»»æ­¢æœŸ
            }
    else:
        datas = {}
        put_text('æ²¡æœ‰ä¿æœŸä¿¡æ¯')
    
    return datas

def æå–æ¡ˆä»¶è¯¦æƒ…åŸé•‡é—¨è¯Šä¿¡æ¯(x):
    if x:
        å§“å = x.get('name')
        ç¥¨æ®å· = x.get('sn')
        å¹å·ä¸‹æ ‡ = x.get('signet')
        è´¦å•ç±»å‹ = x.get('bill_type').get('name')
        åŒ»é™¢åç§° = x.get('hospital').get('name')
        ç–¾ç—…åç§° = x.get('disease').get('name')
        é—¨è¯Šå¤§é¢æ”¯ä»˜ = float(x.get('clinic_charge', 0))
        é€€ä¼‘è¡¥å……æ”¯ä»˜ = float(x.get('retire_charge', 0))
        æ®‹å†›è¡¥åŠ©æ”¯ä»˜ = float(x.get('army_charge', 0))
        å•ä½è¡¥å……é™©æ”¯ä»˜ = float(x.get('staff_charge', 0))
        æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢ = float(x.get('charge', 0))
        ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢ = float(x.get('total_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        åŸºé‡‘æ”¯ä»˜ = float(x.get('fund_pay', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))
        åˆè®¡æ ¡éªŒ = x.get('total_self_charge_check')
        ç¥¨æ®æ—¶é—´ = x.get('occur_time')
        ç¥¨æ ¹ = x.get('attach').get('name')
        æ¡ˆä»¶id = x.get('case_id')
        ç¥¨æ®id = x.get('stub_id')
        é€€å•çŠ¶æ€ = x.get('back_type') # 1é€€å•ï¼Œ0ä¸é€€å•
        ç¥¨æ®ç±»å‹ = 2

        # æ£€æŸ¥æ ‡çº¢
        if åˆè®¡æ ¡éªŒ:
            å­—æ®µæ ‡çº¢ = 'å¦'
        else:
            å­—æ®µæ ‡çº¢ = 'æ˜¯'

        data = {
            'å§“å': å§“å,
            'ç¥¨æ®å·': ç¥¨æ®å·,
            'å¹å·ä¸‹æ ‡': å¹å·ä¸‹æ ‡,
            'è´¦å•ç±»å‹': è´¦å•ç±»å‹,
            'åŒ»é™¢åç§°': åŒ»é™¢åç§°,
            'ç–¾ç—…åç§°': ç–¾ç—…åç§°,
            'é—¨è¯Šå¤§é¢æ”¯ä»˜': é—¨è¯Šå¤§é¢æ”¯ä»˜,
            'é€€ä¼‘è¡¥å……æ”¯ä»˜': é€€ä¼‘è¡¥å……æ”¯ä»˜,
            'æ®‹å†›è¡¥åŠ©æ”¯ä»˜': æ®‹å†›è¡¥åŠ©æ”¯ä»˜,
            'å•ä½è¡¥å……é™©æ”¯ä»˜': å•ä½è¡¥å……é™©æ”¯ä»˜,
            'æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢': æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢,
            'ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢': ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'åŸºé‡‘æ”¯ä»˜': åŸºé‡‘æ”¯ä»˜,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡,
            'ç¥¨æ®æ—¶é—´': ç¥¨æ®æ—¶é—´,
            'ç¥¨æ ¹': ç¥¨æ ¹,
            'æ¡ˆä»¶id': æ¡ˆä»¶id,
            'ç¥¨æ®id': ç¥¨æ®id,
            'é€€å•çŠ¶æ€': é€€å•çŠ¶æ€,
            'ç¥¨æ®ç±»å‹': ç¥¨æ®ç±»å‹,
            'å­—æ®µæ ‡çº¢': å­—æ®µæ ‡çº¢
        }

    else:
        data = {}
        put_text('æ²¡æœ‰åŸé•‡é—¨è¯Šä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶è¯¦æƒ…å±…æ°‘é—¨è¯Šä¿¡æ¯(x):
    if x:
        å§“å = x.get('name')
        ç¥¨æ®å· = x.get('sn')
        å¹å·ä¸‹æ ‡ = x.get('signet')
        è´¦å•ç±»å‹ = x.get('bill_type').get('name')
        åŒ»é™¢åç§° = x.get('hospital').get('name')
        ç–¾ç—…åç§° = x.get('disease').get('name')
        æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢ = float(x.get('charge', 0))
        ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢ = float(x.get('total_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        åŸºé‡‘æ”¯ä»˜ = float(x.get('fund_pay', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))
        åˆè®¡æ ¡éªŒ = x.get('total_self_charge_check')
        ç¥¨æ®æ—¶é—´ = x.get('occur_time')
        ç¥¨æ ¹ = x.get('attach').get('name')
        æ¡ˆä»¶id = x.get('case_id')
        ç¥¨æ®id = x.get('stub_id')
        é€€å•çŠ¶æ€ = x.get('back_type') # 1é€€å•ï¼Œ0ä¸é€€å•
        ç¥¨æ®ç±»å‹ = 1
        # æ£€æŸ¥æ ‡çº¢
        if åˆè®¡æ ¡éªŒ:
            å­—æ®µæ ‡çº¢ = 'å¦'
        else:
            å­—æ®µæ ‡çº¢ = 'æ˜¯'

        data = {
            'å§“å': å§“å,
            'ç¥¨æ®å·': ç¥¨æ®å·,
            'å¹å·ä¸‹æ ‡': å¹å·ä¸‹æ ‡,
            'è´¦å•ç±»å‹': è´¦å•ç±»å‹,
            'åŒ»é™¢åç§°': åŒ»é™¢åç§°,
            'ç–¾ç—…åç§°': ç–¾ç—…åç§°,
            'æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢': æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢,
            'ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢': ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'åŸºé‡‘æ”¯ä»˜': åŸºé‡‘æ”¯ä»˜,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡,
            'ç¥¨æ®æ—¶é—´': ç¥¨æ®æ—¶é—´,
            'ç¥¨æ ¹': ç¥¨æ ¹,
            'æ¡ˆä»¶id': æ¡ˆä»¶id,
            'ç¥¨æ®id': ç¥¨æ®id,
            'é€€å•çŠ¶æ€': é€€å•çŠ¶æ€,
            'ç¥¨æ®ç±»å‹': ç¥¨æ®ç±»å‹,
            'å­—æ®µæ ‡çº¢': å­—æ®µæ ‡çº¢
        }

    else:
        data = {}
        print('æ²¡æœ‰å±…æ°‘é—¨è¯Šä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶è¯¦æƒ…åŸé•‡é—¨è¯Šåˆè®¡ä¿¡æ¯(x):
    if x:
        é—¨è¯Šå¤§é¢æ”¯ä»˜ = float(x.get('clinic_charge', 0))
        é€€ä¼‘è¡¥å……æ”¯ä»˜ = float(x.get('retire_charge', 0))
        æ®‹å†›è¡¥åŠ©æ”¯ä»˜ = float(x.get('army_charge', 0))
        å•ä½è¡¥å……é™©æ”¯ä»˜ = float(x.get('staff_charge', 0))
        æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢ = float(x.get('charge', 0))
        ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢ = float(x.get('total_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        åŸºé‡‘æ”¯ä»˜ = float(x.get('fund_pay', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))

        data = {
            'é—¨è¯Šå¤§é¢æ”¯ä»˜': é—¨è¯Šå¤§é¢æ”¯ä»˜,
            'é€€ä¼‘è¡¥å……æ”¯ä»˜': é€€ä¼‘è¡¥å……æ”¯ä»˜,
            'æ®‹å†›è¡¥åŠ©æ”¯ä»˜': æ®‹å†›è¡¥åŠ©æ”¯ä»˜,
            'å•ä½è¡¥å……é™©æ”¯ä»˜': å•ä½è¡¥å……é™©æ”¯ä»˜,
            'æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢': æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢,
            'ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢': ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'åŸºé‡‘æ”¯ä»˜': åŸºé‡‘æ”¯ä»˜,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡}
    else:
        data = {}
        print('æ²¡æœ‰é—¨è¯Šåˆè®¡ä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶è¯¦æƒ…å±…æ°‘é—¨è¯Šåˆè®¡ä¿¡æ¯(x):
    if x:
        æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢ = float(x.get('charge', 0))
        ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢ = float(x.get('total_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        åŸºé‡‘æ”¯ä»˜ = float(x.get('fund_pay', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))

        data = {
            'æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢': æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢,
            'ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢': ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'åŸºé‡‘æ”¯ä»˜': åŸºé‡‘æ”¯ä»˜,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡}
    else:
        data = {}
        print('æ²¡æœ‰é—¨è¯Šåˆè®¡ä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶è¯¦æƒ…ä½é™¢ä¿¡æ¯(x):
    if x:
        å§“å = x.get('name')
        ç¥¨æ®å· = x.get('sn')
        å¹å·ä¸‹æ ‡ = x.get('signet')
        è´¦å•ç±»å‹ = x.get('bill_type').get('name')
        åŒ»é™¢åç§° = x.get('hospital').get('name')
        ç–¾ç—…åç§° = x.get('disease').get('name')
        åŒ»ç–—ä¿é™©èŒƒå›´å†…é‡‘é¢ = float(x.get('insurance_charge', 0))
        åŒ»ç–—ä¿é™©åŸºé‡‘æ”¯ä»˜é‡‘é¢ = float(x.get('sum_insurance_charge', 0))
        ç»Ÿç­¹åŸºé‡‘ = float(x.get('whole_charge', 0))
        é€€ä¼‘è¡¥å……åŒ»ç–—ä¿é™© = float(x.get('retire_charge', 0))
        æ®‹å†›è¡¥åŠ©æ”¯ä»˜ = float(x.get('army_charge', 0))
        å•ä½è¡¥å……é™©æ”¯ä»˜ = float(x.get('staff_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))
        åˆè®¡æ ¡éªŒ = x.get('total_self_charge_check')
        å…¥é™¢æ—¶é—´ = x.get('in_time')
        å‡ºé™¢æ—¶é—´ = x.get('out_time')
        ç¥¨æ ¹ = x.get('attach').get('name')
        æ¡ˆä»¶id = x.get('case_id')
        ç¥¨æ®id = x.get('stub_id')
        é€€å•çŠ¶æ€ = x.get('back_type') # 1é€€å•ï¼Œ0ä¸é€€å•
        ç¥¨æ®ç±»å‹ = 3
        # æ£€æŸ¥æ ‡çº¢
        if åˆè®¡æ ¡éªŒ:
            å­—æ®µæ ‡çº¢ = 'å¦'
        else:
            å­—æ®µæ ‡çº¢ = 'æ˜¯'

        data = {
            'å§“å': å§“å,
            'ç¥¨æ®å·': ç¥¨æ®å·,
            'å¹å·ä¸‹æ ‡': å¹å·ä¸‹æ ‡,
            'è´¦å•ç±»å‹': è´¦å•ç±»å‹,
            'åŒ»é™¢åç§°': åŒ»é™¢åç§°,
            'ç–¾ç—…åç§°': ç–¾ç—…åç§°,
            'åŒ»ç–—ä¿é™©èŒƒå›´å†…é‡‘é¢': åŒ»ç–—ä¿é™©èŒƒå›´å†…é‡‘é¢,
            'åŒ»ç–—ä¿é™©åŸºé‡‘æ”¯ä»˜é‡‘é¢': åŒ»ç–—ä¿é™©åŸºé‡‘æ”¯ä»˜é‡‘é¢,
            'ç»Ÿç­¹åŸºé‡‘': ç»Ÿç­¹åŸºé‡‘,
            'é€€ä¼‘è¡¥å……åŒ»ç–—ä¿é™©': é€€ä¼‘è¡¥å……åŒ»ç–—ä¿é™©,
            'æ®‹å†›è¡¥åŠ©æ”¯ä»˜': æ®‹å†›è¡¥åŠ©æ”¯ä»˜,
            'å•ä½è¡¥å……é™©æ”¯ä»˜': å•ä½è¡¥å……é™©æ”¯ä»˜,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡,
            'å…¥é™¢æ—¶é—´': å…¥é™¢æ—¶é—´,
            'å‡ºé™¢æ—¶é—´': å‡ºé™¢æ—¶é—´,
            'ç¥¨æ ¹': ç¥¨æ ¹,
            'æ¡ˆä»¶id': æ¡ˆä»¶id,
            'ç¥¨æ®id': ç¥¨æ®id,
            'é€€å•çŠ¶æ€': é€€å•çŠ¶æ€,
            'ç¥¨æ®ç±»å‹': ç¥¨æ®ç±»å‹,
            'å­—æ®µæ ‡çº¢': å­—æ®µæ ‡çº¢
        }

    else:
        data = {}
        print('æ²¡æœ‰ä½é™¢ä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶è¯¦æƒ…ä½é™¢åˆè®¡ä¿¡æ¯(x):
    if x:
        åŒ»ç–—ä¿é™©èŒƒå›´å†…é‡‘é¢ = float(x.get('insurance_charge', 0))
        åŒ»ç–—ä¿é™©åŸºé‡‘æ”¯ä»˜é‡‘é¢ = float(x.get('sum_insurance_charge', 0))
        ç»Ÿç­¹åŸºé‡‘ = float(x.get('whole_charge', 0))
        é€€ä¼‘è¡¥å……åŒ»ç–—ä¿é™© = float(x.get('retire_charge', 0))
        æ®‹å†›è¡¥åŠ©æ”¯ä»˜ = float(x.get('army_charge', 0))
        å•ä½è¡¥å……é™©æ”¯ä»˜ = float(x.get('staff_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))

        data = {
            'åŒ»ç–—ä¿é™©èŒƒå›´å†…é‡‘é¢': åŒ»ç–—ä¿é™©èŒƒå›´å†…é‡‘é¢,
            'åŒ»ç–—ä¿é™©åŸºé‡‘æ”¯ä»˜é‡‘é¢': åŒ»ç–—ä¿é™©åŸºé‡‘æ”¯ä»˜é‡‘é¢,
            'ç»Ÿç­¹åŸºé‡‘': ç»Ÿç­¹åŸºé‡‘,
            'é€€ä¼‘è¡¥å……åŒ»ç–—ä¿é™©': é€€ä¼‘è¡¥å……åŒ»ç–—ä¿é™©,
            'æ®‹å†›è¡¥åŠ©æ”¯ä»˜': æ®‹å†›è¡¥åŠ©æ”¯ä»˜,
            'å•ä½è¡¥å……é™©æ”¯ä»˜': å•ä½è¡¥å……é™©æ”¯ä»˜,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡
        }
    else:
        data = {}
        print('æ²¡æœ‰ä½é™¢åˆè®¡ä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶è¯¦æƒ…é—¨ç‰¹ä¿¡æ¯(x):
    if x:
        å§“å = x.get('name')
        ç¥¨æ®å· = x.get('sn')
        å¹å·ä¸‹æ ‡ = x.get('signet')
        è´¦å•ç±»å‹ = x.get('bill_type').get('name')
        åŒ»é™¢åç§° = x.get('hospital').get('name')
        ç–¾ç—…åç§° = x.get('disease').get('name')
        ç»Ÿç­¹åŸºé‡‘æ”¯ä»˜ = float(x.get('whole_charge', 0))
        ä½é™¢å¤§é¢æ”¯ä»˜ = float(x.get('clinic_charge', 0))
        é€€ä¼‘è¡¥å……æ”¯ä»˜ = float(x.get('retire_charge', 0))
        æ®‹å†›è¡¥åŠ©æ”¯ä»˜ = float(x.get('army_charge', 0))
        å•ä½è¡¥å……é™©æ”¯ä»˜ = float(x.get('staff_charge', 0))
        æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢ = float(x.get('charge', 0))
        ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢ = float(x.get('total_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        åŸºé‡‘æ”¯ä»˜ = float(x.get('fund_pay', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))
        åˆè®¡æ ¡éªŒ = x.get('total_self_charge_check')
        ç¥¨æ®æ—¶é—´ = x.get('occur_time')
        ç¥¨æ ¹ = x.get('attach').get('name')
        æ¡ˆä»¶id = x.get('case_id')
        ç¥¨æ®id = x.get('stub_id')
        é€€å•çŠ¶æ€ = x.get('back_type') # 1é€€å•ï¼Œ0ä¸é€€å•
        ç¥¨æ®ç±»å‹ = 5
        # æ£€æŸ¥æ ‡çº¢
        if åˆè®¡æ ¡éªŒ:
            å­—æ®µæ ‡çº¢ = 'å¦'
        else:
            å­—æ®µæ ‡çº¢ = 'æ˜¯'

        data = {
            'å§“å': å§“å,
            'ç¥¨æ®å·': ç¥¨æ®å·,
            'å¹å·ä¸‹æ ‡': å¹å·ä¸‹æ ‡,
            'è´¦å•ç±»å‹': è´¦å•ç±»å‹,
            'åŒ»é™¢åç§°': åŒ»é™¢åç§°,
            'ç–¾ç—…åç§°': ç–¾ç—…åç§°,
            'ç»Ÿç­¹åŸºé‡‘æ”¯ä»˜': ç»Ÿç­¹åŸºé‡‘æ”¯ä»˜,
            'ä½é™¢å¤§é¢æ”¯ä»˜': ä½é™¢å¤§é¢æ”¯ä»˜,
            'é€€ä¼‘è¡¥å……æ”¯ä»˜': é€€ä¼‘è¡¥å……æ”¯ä»˜,
            'æ®‹å†›è¡¥åŠ©æ”¯ä»˜': æ®‹å†›è¡¥åŠ©æ”¯ä»˜,
            'å•ä½è¡¥å……é™©æ”¯ä»˜': å•ä½è¡¥å……é™©æ”¯ä»˜,
            'æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢': æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢,
            'ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢': ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'åŸºé‡‘æ”¯ä»˜': åŸºé‡‘æ”¯ä»˜,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡,
            'ç¥¨æ®æ—¶é—´': ç¥¨æ®æ—¶é—´,
            'ç¥¨æ ¹': ç¥¨æ ¹,
            'æ¡ˆä»¶id': æ¡ˆä»¶id,
            'ç¥¨æ®id': ç¥¨æ®id,
            'é€€å•çŠ¶æ€': é€€å•çŠ¶æ€,
            'ç¥¨æ®ç±»å‹': ç¥¨æ®ç±»å‹,
            'å­—æ®µæ ‡çº¢': å­—æ®µæ ‡çº¢
        }
    else:
        data = {}
        print('æ²¡æœ‰é—¨ç‰¹ä¿¡æ¯')
    return data

def æå–æ¡ˆä»¶è¯¦æƒ…é—¨ç‰¹åˆè®¡ä¿¡æ¯(x):
    if x:
        ç»Ÿç­¹åŸºé‡‘æ”¯ä»˜ = float(x.get('whole_charge', 0))
        ä½é™¢å¤§é¢æ”¯ä»˜ = float(x.get('clinic_charge', 0))
        é€€ä¼‘è¡¥å……æ”¯ä»˜ = float(x.get('retire_charge', 0))
        æ®‹å†›è¡¥åŠ©æ”¯ä»˜ = float(x.get('army_charge', 0))
        å•ä½è¡¥å……é™©æ”¯ä»˜ = float(x.get('staff_charge', 0))
        æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢ = float(x.get('charge', 0))
        ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢ = float(x.get('total_charge', 0))
        è‡ªä»˜ä¸€ = float(x.get('self_charge_1', 0))
        èµ·ä»˜é‡‘é¢ = float(x.get('self_charge_1_min', 0))
        è¶…å°é¡¶é‡‘é¢ = float(x.get('self_charge_1_max', 0))
        è‡ªä»˜äºŒ = float(x.get('self_charge_2', 0))
        è‡ªè´¹ = float(x.get('self_charge', 0))
        åŸºé‡‘æ”¯ä»˜ = float(x.get('fund_pay', 0))
        ä¸ªäººæ”¯ä»˜ = float(x.get('person_pay', 0))
        åˆè®¡ = float(x.get('total_self_charge', 0))

        data = {
            'ç»Ÿç­¹åŸºé‡‘æ”¯ä»˜': ç»Ÿç­¹åŸºé‡‘æ”¯ä»˜,
            'ä½é™¢å¤§é¢æ”¯ä»˜': ä½é™¢å¤§é¢æ”¯ä»˜,
            'é€€ä¼‘è¡¥å……æ”¯ä»˜': é€€ä¼‘è¡¥å……æ”¯ä»˜,
            'æ®‹å†›è¡¥åŠ©æ”¯ä»˜': æ®‹å†›è¡¥åŠ©æ”¯ä»˜,
            'å•ä½è¡¥å……é™©æ”¯ä»˜': å•ä½è¡¥å……é™©æ”¯ä»˜,
            'æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢': æœ¬æ¬¡åŒ»ä¿èŒƒå›´å†…é‡‘é¢,
            'ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢': ç´¯è®¡åŒ»ä¿å†…èŒƒå›´é‡‘é¢,
            'è‡ªä»˜ä¸€': è‡ªä»˜ä¸€,
            'èµ·ä»˜é‡‘é¢': èµ·ä»˜é‡‘é¢,
            'è¶…å°é¡¶é‡‘é¢': è¶…å°é¡¶é‡‘é¢,
            'è‡ªä»˜äºŒ': è‡ªä»˜äºŒ,
            'è‡ªè´¹': è‡ªè´¹,
            'åŸºé‡‘æ”¯ä»˜': åŸºé‡‘æ”¯ä»˜,
            'ä¸ªäººæ”¯ä»˜': ä¸ªäººæ”¯ä»˜,
            'åˆè®¡': åˆè®¡
        }
    else:
        data = {}
        print('æ²¡æœ‰é—¨ç‰¹åˆè®¡ä¿¡æ¯')
    return data

def æå–é¢†æ¬¾äººä¿¡æ¯(x):
    if x:
        å§“å = x.get('name')
        æ€§åˆ« = x.get('gender_name')
        å‡ºç”Ÿæ—¥æœŸ = x.get('birth_name')
        è¯ä»¶ç±»å‹ = x.get('id_type_name')
        è¯ä»¶å·ç  = x.get('id_no')
        è¯ä»¶ç­¾å‘æ—¥æœŸ = x.get('id_begin_time_name')
        è¯ä»¶å¤±æ•ˆæ—¥æœŸ = x.get('id_end_time_name')
        è¯ä»¶ä¸ºé•¿æœŸ = x.get('id_long_time')  # 0å¦ 1æ˜¯
        å›½ç± = x.get('country_code_name')
        é¢†æ¬¾äººä¸å—ç›Šäººå…³ç³» = x.get('beneficiary_relation_name')

        data = {
            'å§“å': å§“å,
            'æ€§åˆ«': æ€§åˆ«,
            'å‡ºç”Ÿæ—¥æœŸ': å‡ºç”Ÿæ—¥æœŸ,
            'è¯ä»¶ç±»å‹': è¯ä»¶ç±»å‹,
            'è¯ä»¶å·ç ': è¯ä»¶å·ç ,
            'è¯ä»¶ç­¾å‘æ—¥æœŸ': è¯ä»¶ç­¾å‘æ—¥æœŸ,
            'è¯ä»¶å¤±æ•ˆæ—¥æœŸ': è¯ä»¶å¤±æ•ˆæ—¥æœŸ,
            'è¯ä»¶ä¸ºé•¿æœŸ': è¯ä»¶ä¸ºé•¿æœŸ,
            'å›½ç±': å›½ç±,
            'é¢†æ¬¾äººä¸å—ç›Šäººå…³ç³»': é¢†æ¬¾äººä¸å—ç›Šäººå…³ç³»
        }
    else:
        data = {}
        print('æ²¡æœ‰é¢†æ¬¾äººä¿¡æ¯')
    return data

def æå–å—ç›Šäººä¿¡æ¯(x):
    if x:
        å§“å = x.get('name')
        æ€§åˆ« = x.get('gender_name')
        å‡ºç”Ÿæ—¥æœŸ = x.get('birth_name')
        è¯ä»¶ç±»å‹ = x.get('id_type_name')
        è¯ä»¶å·ç  = x.get('id_no')
        è¯ä»¶ç­¾å‘æ—¥æœŸ = x.get('id_begin_time_name')
        è¯ä»¶å¤±æ•ˆæ—¥æœŸ = x.get('id_end_time_name')
        è¯ä»¶ä¸ºé•¿æœŸ = x.get('id_long_time')  # 0å¦ 1æ˜¯
        å›½ç± = x.get('country_code_name')
        å—ç›Šäººä¸è¢«ä¿é™©äººå…³ç³» = x.get('beneficiary_relation_name')

        data = {
            'å§“å': å§“å,
            'æ€§åˆ«': æ€§åˆ«,
            'å‡ºç”Ÿæ—¥æœŸ': å‡ºç”Ÿæ—¥æœŸ,
            'è¯ä»¶ç±»å‹': è¯ä»¶ç±»å‹,
            'è¯ä»¶å·ç ': è¯ä»¶å·ç ,
            'è¯ä»¶ç­¾å‘æ—¥æœŸ': è¯ä»¶ç­¾å‘æ—¥æœŸ,
            'è¯ä»¶å¤±æ•ˆæ—¥æœŸ': è¯ä»¶å¤±æ•ˆæ—¥æœŸ,
            'è¯ä»¶ä¸ºé•¿æœŸ': è¯ä»¶ä¸ºé•¿æœŸ,
            'å›½ç±': å›½ç±,
            'å—ç›Šäººä¸è¢«ä¿é™©äººå…³ç³»': å—ç›Šäººä¸è¢«ä¿é™©äººå…³ç³»
        }
    else:
        data = {}
        print('æ²¡æœ‰å—ç›Šäººä¿¡æ¯')
    return data

def æå–é€€å•å†…å®¹(x):
    if x:
        x1 = x['total_drug'][0]['note'][0]
        é€€å•åŸå›  = x1['name']
        é—®é¢˜æè¿° = x1['descript']
        é€€å•ç±»å‹ = x1['back_type']  # 1æ˜¯æ•´å¼ é€€å•ï¼Œ2æ˜¯éƒ¨åˆ†é€€å•

        data = {
            'é€€å•åŸå› ': é€€å•åŸå› ,
            'é—®é¢˜æè¿°': é—®é¢˜æè¿°,
            'é€€å•ç±»å‹': é€€å•ç±»å‹
        }
    else:
        data = {}
        put_text('æ²¡æœ‰é€€å•åŸå› ')
    return data

def è·å–æ¡ˆä»¶ä¿¡æ¯(url, headers):
    s = requests.Session()
    s.mount('http://', HTTPAdapter(max_retries=3))
    s.mount('https://', HTTPAdapter(max_retries=3))
    try:
        req = s.get(url=url, headers=headers, timeout=200)
        r = req.json()
        a = r.get('msg')
        if a == 'è¯·æ±‚æˆåŠŸ':
            datas = r.get('data')  # æ¡ˆä»¶åˆ—è¡¨è¦åˆ†ç¦»2æ¬¡ï¼Œæ¡ˆä»¶è¯¦æƒ…åˆ†ç¦»1æ¬¡ã€‚

        else:
            datas = a
            print(a)
        
        # else:
        #     print(datetime.now())
        #     print(a)
        #     # put_text(a)
        #     datas = {}
            
    except Exception as e:
        # è¾“å‡ºé”™è¯¯æç¤º
        print(datetime.now())
        exstr = traceback.format_exc()
        print(f'exstr = {exstr}')
        print(f'e = {e}')
        datas = {}

    return datas

if __name__ == '__main__':
    headers = æ£€æŸ¥ç™»å½•çŠ¶æ€('è¾“å…¥è´¦å·')
